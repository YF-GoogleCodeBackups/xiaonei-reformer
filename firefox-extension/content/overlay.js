function loader(evt) {
	var docWindow=content;
	if(evt) {
		docWindow=evt.target.defaultView.window;
		if(docWindow==docWindow.parent) {
			return;
		}
	}
	if(!docWindow.location.href.match("https?://.*\\.renren\\.com|https?://renren\\.com")) {
		return;
	}

// ==UserScript==
// @name           校内人人网改造器 Xiaonei Reformer Exp
// @namespace      Xiaonei_reformer_exp
// @include        http://renren.com/*
// @include        http://*.renren.com/*
// @include        https://renren.com/*
// @include        https://*.renren.com/*
// @description    为人人网（renren.com，原校内网xiaonei.com）清理广告、新鲜事、各种烦人的通告，删除页面模板，恢复旧的深蓝色主题，增加更多功能。。。
// @version        3.0.0.20100527
// @miniver        300
// @author         xz
// ==/UserScript==
//
// Copyright (C) 2008-2010 Xu Zhen
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.
//

(function(_window){var window=_window;var document=_window.document;if(window.self!=window.top&&document.designMode=="on"){return}var $=PageKit;var XNR={};XNR.version="3.0.0.20100527";XNR.miniver=300;XNR.storage={};XNR.userId="0";XNR.debug=false;XNR.options={};const UNKNOWN=0,USERSCRIPT=1,FIREFOX=2,CHROME=4;XNR.agent=UNKNOWN;if(window.chrome){XNR.agent=CHROME}else{if(typeof gBrowser!="undefined"){XNR.agent=FIREFOX}else{if(typeof GM_setValue=="function"){XNR.agent=USERSCRIPT}}}function removeAds(evt){if(!evt){var ads=".ad-bar, .banner, .adimgr, .blank-bar, .renrenAdPanel, .side-item.template, .rrdesk, .video:not([style]), #sd_ad, #showAD, #huge-ad, #rrtvcSearchTip, #top-ads, #bottom-ads, #main-ads, #n-cAD";$patchCSS(ads+"{display:none !important}");$wait(1,function(){$(ads).remove();$(".blank-holder").remove(true)})}$wait(1,function(){$("ul#feedHome > li").filter("a[href^='http://edm.renren.com/link.do?']").remove();$("ul#feedHome > li").filter("a[href^='http://im.renren.com/'][href*='.exe']").remove()})}function removePageTheme(){var themes=["head link[rel='stylesheet'][href*='/csspro/themes/'][href*='.css']","#hometpl_style","head link[rel='stylesheet'][href*='zidou_nav.css']","#domain_wrapper","#themeLink"];$(themes.join(",")).remove();$("head style").each(function(elem){var theme=$(elem);if(theme.text().contains("url(http://i.static.renren.com")){theme.remove();return true}});var logo=$("img[src*='viplogo-renren.png']").attr({height:null,width:null});if(logo.size()>0){logo.attr("src",logo.attr("src").replace("viplogo-renren.png","logo-renren.png"))}}function removeStarReminder(){var target="#tobestar, #realheadbulletin, #noStarNotice, #nostar, #home_nostar";$patchCSS(target+"{display:none !important}");$wait(1,function(){$(target).remove()})}function extendPrototype(){if(!String.prototype.contains){String.prototype.contains=function(str){return this.indexOf(str)!=-1}}if(!String.prototype.repeat){String.prototype.repeat=function(times){var a="";for(;times>0;times--){a+=this}return a}}if(!Date.prototype.format){Date.prototype.format=function(fmt){var o={"y+":this.getFullYear(),"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),};for(var i in o){if(new RegExp("("+i+")").test(fmt)){fmt=fmt.replace(RegExp.$1,"0".repeat(RegExp.$1.length-o[i].toString().length)+o[i])}}return fmt}}}function main(savedOptions){extendPrototype();var optionMenu={"清理页面":[{text:"##清除各类广告",ctrl:[{id:"removeAds",type:"check",value:true,fn:[{name:removeAds,stage:0,fire:{prop:"checked",value:true},trigger:{"ul#feedHome":"DOMNodeInserted"},}],}],},{text:"##去除页面主题模板",ctrl:[{id:"removePageTheme",type:"check",value:false,fn:[{name:removePageTheme,stage:1,fire:{prop:"checked",value:true},}],}],},{text:"##去除升级星级用户提示",ctrl:[{id:"removeStarReminder",type:"check",value:true,fn:[{name:removeStarReminder,stage:0,fire:{prop:"checked",value:true},}],}],}],};var fnQueue=[[],[],[],[]];var categoryHTML="";var categoryPages=[];for(var category in optionMenu){categoryHTML+='<li class="'+(categoryPages.length%2!=0?"even":"odd")+'"><span>'+category+"</span></li>";var page=$node("div");for(iFunc=0;iFunc<optionMenu[category].length;iFunc++){var o=optionMenu[category][iFunc];if(o.agent&&(o.agent&XNR.agent)==0){return}if(!o.column){var block=$node("div");var text=o.text.split("##");for(var iText=0;iText<text.length;iText++){if(text[iText]){$node("label").text(text[iText]).appendTo(block)}var control=o.ctrl[iText];if(!control){continue}if(savedOptions[control.id]!=null){control.value=savedOptions[control.id]}var node=null;switch(control.type){case"check":node=$node("input").attr("type","checkbox");break;case"hidden":break;case"input":node=$node("input");break;case"edit":node=$node("textarea");break;case"button":node=$node("input").attr("type","button");break;case"label":node=$node("span");break}if(node){node.value(control.value);node.attr({id:control.id,style:(control.style||"")});node.appendTo(block)}XNR.options[control.id]=control.value;if(control.fn){for(var iFn=0;iFn<control.fn.length;iFn++){var fn=control.fn[iFn];if(!fn.args){fn.args=[]}if(!fn.fire||(typeof fn.fire=="object"&&node.prop(fn.fire.prop)==fn.fire.value)){fnQueue[fn.stage].push({name:fn.name,args:fn.args})}else{if(typeof fn.fire=="string"){node.hook(fn.fire,function(evt){fn.name(evt,fn.args[0],fn.args[1],fn.args[2],fn.args[3])})}}if(fn.trigger){fnQueue[(fn.stage==0?1:fn.stage)].push({name:fn.name,args:fn.args,trigger:fn.trigger})}}}}page.append(block)}else{}}categoryPages.push(page.style("display","none").get())}for(var iStage=0;iStage<4;iStage++){for(var i=0;i<fnQueue[iStage].length;i++){var fn=fnQueue[iStage][i];if(!fn.args){continue}for(var iArg=0;iArg<4;iArg++){if(typeof fn.args[iArg]=="string"&&fn.args[iArg].charAt(0)=="@"){fn.args[iArg]=XNR.options[fn.args[iArg].substring(1)]}}}}for(var i=0;i<fnQueue[0].length;i++){var fn=fnQueue[0][i];fn.name(fn.args[0],fn.args[1],fn.args[2],fn.args[3])}var menuHTML='<style type="text/css">.xnr_op{width:500px;left:50%;margin-left:-225px;position:fixed;z-index:200000;color:black;blackground:black;font-size:12px}.xnr_op *{padding:0;margin:0;border-collapse:collapse}.xnr_op a{color:#3B5990}.xnr_op table{width:100%;table-layout:fixed}.xnr_op .tl{border-top-left-radius:8px;-moz-border-radius-topleft:8px}.xnr_op .tr{border-top-right-radius:8px;-moz-border-radius-topright:8px}.xnr_op .bl{border-bottom-left-radius:8px;-moz-border-radius-bottomleft:8px}.xnr_op .br{border-bottom-right-radius:8px;-moz-border-radius-bottomright:8px}.xnr_op .border{height:10px;overflow:hidden;width:10px;background-color:black;opacity:0.5}.xnr_op .m{width:100%}.xnr_op .title {padding:4px;display:block;background:#3B5998;color:white;text-align:center;font-size:12px}.xnr_op .btns{background:#F0F5F8;text-align:right}.xnr_op .btns>input{border-style:solid;border-width:1px;padding:2px 15px;margin:3px;font-size:13px}.xnr_op .ok{background:#5C75AA;color:white;border-color:#B8D4E8 #124680 #124680 #B8D4E8}.xnr_op .cancel{background:#F0F0F0;border-color:#FFFFFF #848484 #848484 #FFFFFF}.xnr_op>table table{background:#FFFFF4}.xnr_op .options>table{height:280px;border-spacing:0}.xnr_op .c td{vertical-align:top}.xnr_op .category{width:119px;min-width:119px;border-right:1px solid #5C75AA}.xnr_op li{list-style-type:none}.xnr_op .category li{cursor:pointer;height:30px;overflow:hidden}.xnr_op .category li:hover{background:#ffffcc;color:black}.xnr_op li.even{background:#EEEEEE}.xnr_op li.selected{background:#748AC4;color:white}.xnr_op .category span{left:10px;position:relative;font-size:14px;line-height:30px}.xnr_op .pages>div{overflow:auto;height:280px;padding:10px}.xnr_op .pages>div>*{margin-bottom:5px;width:100%}.xnr_op .pages>div>div>table{margin-left:5px}.xnr_op .pages tr{line-height:20px}.xnr_op input[type="checkbox"]{margin-right:4px}.xnr_op label{color:black;font-weight:normal}.xnr_op .pages .default{text-align:center}.xnr_op .pages .default table{height:95%}.xnr_op .pages .default td{vertical-align:middle}.xnr_op .pages .default td>*{padding:5px}</style>';menuHTML+='<table><tbody><tr><td class="border tl"></td><td class="border m"></td><td class="border tr"></td></tr><tr><td class="border"></td><td class="c m"><div class="title">改造选项</div><div class="options"><table><tbody><tr><td class="category"><ul>'+categoryHTML+'</ul></td><td class="pages"><div class="default"><table><tbody><tr><td><h1>人人网改造器</h1><p><b>'+XNR.version+" ("+XNR.miniver+')</b></p><p><b>Copyright © 2008-2010</b></p><p><a href="mailto:xnreformer@gmail.com">xnreformer@gmail.com</a></p><p><a href="http://xiaonei-reformer.googlecode.com/" target="_blank">项目主页</a></p></td></tr></tbody></table></div></td></tr></tbody></table></div><div class="btns"><input type="button" value="确定" class="ok"/><input type="button" value="取消" class="cancel"/></div></td><td class="border"></td></tr><tr><td class="border bl"></td><td class="border m"></td><td class="border br"></td></tr></tbody></table>';var menu=$node("div").attr("class","xnr_op").style("display","none").code(menuHTML).appendTo(document.documentElement);menu.find("td.pages").append($(categoryPages));menu.find(".category ul").hook("click",function(evt){var t=$(evt.target);if(t.prop("tagName")=="SPAN"){t=t.superior()}$(".xnr_op .pages>div").hide();$(".xnr_op .pages>div").pick(t.index()+1).show();$(".xnr_op .category li.selected").removeClass("selected");t.addClass("selected")});menu.find(".cancel").hook("click",function(evt){menu.hide();for(op in XNR.options){var c=menu.find("#"+op);if(c.empty()){continue}else{c.value(XNR.options[op])}}});menu.find(".ok").hook("click",function(evt){for(op in XNR.options){var c=menu.find("#"+op);if(c.empty()){continue}else{var newValue=c.value();if(XNR.options[op]!=newValue){$save(op,newValue)}}}window.location.reload()});var entry=$node("div").attr("class","menu").append($node("div").attr("class","menu-title").append($node("a").attr({href:"#nogo",onclick:"return false"}).text("改造")));entry.find("a").hook("click",function(){menu.show().style("top",parseInt(window.innerHeight-menu.prop("offsetHeight"))/2+"px")});$wait(1,function(){entry.prependTo($(".nav-body .nav-other"));for(var p=1;p<3;p++){for(var i=0;i<fnQueue[p].length;i++){var fn=fnQueue[p][i];if(fn.trigger){for(var t in fn.trigger){$(t).hook(fn.trigger[t],function(evt){fn.name(evt,fn.args[0],fn.args[1],fn.args[2],fn.args[3])})}}else{fn.name(fn.args[0],fn.args[1],fn.args[2],fn.args[3])}}}});$wait(3,function(){for(var i=0;i<fnQueue[3].length;i++){var fn=fnQueue[3][i];if(fn.trigger){for(var t in fn.trigger){$(t).hook(fn.trigger[t],function(evt){fn.name(evt,fn.args[0],fn.args[1],fn.args[2],fn.args[3])})}}else{fn.name(fn.args[0],fn.args[1],fn.args[2],fn.args[3])}}})}function $cookie(name,def){var cookies=document.cookie.split(";");name=escape(name);for(var i=0;i<cookies.length;i++){var c=cookies[i].replace(/^ +/g,"");if(c.indexOf(name+"=")==0){return unescape(c.substring(name.length+1,c.length))}}return def||""}function $node(name){if(!name){return PageKit(document.createTextNode(""))}else{return PageKit(document.createElement(name))}}function $page(category,url){var pages={home:"renren\\.com/[hH]ome\\.do",profile:"/[Pp]rofile\\.do|/[a-zA-Z0-9_]{5,}\\.renren.com/\\?id=",blog:"blog\\.renren\\.com",};if(!url){url=window.location.href}return !pages[category]||url.match(pages[category])}function $alloc(name,monopoly){if(!name){do{name="r"+Math.random()}while(!XNR.storage[name])}if(storage[name]){if(monopoly){return null}else{return XNR.storage[name]}}else{XNR.storage[name]=new Object();return XNR.storage[name]}}function $dealloc(name){XNR.storage[name]=null}function $popup(title,content,geometry,stayTime,popSpeed){const timeout=50;var node=$node("div").style({position:"fixed",backgroundColor:"#F0F5F8",border:"1px solid #B8D4E8",zIndex:100000,overflow:"hidden"});var geo=/^(\d+)x\d+([+-]?)(\d*)([+-]?)(\d*)$/.exec(geometry);if(!geo){geo=["","200","+","5","-","5"]}node.style("width",(geo[1]=="0"?"auto":geo[1]+"px")).style((geo[2]||"+")=="+"?"left":"right",(geo[3]||"0")+"px").style((geo[4]||"-")=="+"?"top":"bottom",(geo[5]||"0")+"px");var closeLink=$node("a").style({cssFloat:"right",fontSize:"x-small",color:"white",cursor:"pointer"}).text("关闭").hook("click",function(){node.remove()});node.append($node("div").text((title||"提示")).append(closeLink).style({background:"#526EA6",color:"white",fontWeight:"bold",fontSize:"normal",padding:"3px"}));node.append($node("div").style("margin","5px").code(content)).appendTo(document.body);var maxHeight=parseInt(node.prop("clientHeight"));node.style("height","0px");setTimeout(function(){try{var h=parseInt(node.style("height"));if(h<maxHeight){var diff=maxHeight-h;node.style("height",(h+(diff>popSpeed?popSpeed:diff))+"px");setTimeout(arguments.callee,timeout)}else{setTimeout(function(){try{var h=parseInt(node.style("height"));if(h<=0){node.remove()}else{node.style("height",(h>popSpeed?h-popSpeed:0)+"px");setTimeout(arguments.callee,timeout)}}catch(err){}},stayTime*1000);closeLink.text("关闭("+stayTime+")");var timer=setInterval(function(){if(!node||stayTime<=0){clearInterval(timer)}else{stayTime--;closeLink.text("关闭("+stayTime+")")}},1000)}}catch(err){}},timeout);return node}function $wait(stage,func){var curStage=2;if(document.readyState=="loading"){curStage=0}else{if(document.readyState=="completed"){curStage=3}else{if(stage==1||stage==2){curStage=stage}}}if(stage>curStage){if(stage<3){document.addEventListener("DOMContentLoaded",func,false)}else{if(stage==3){document.addEventListener("load",func,false)}}}else{func()}}function $patchCSS(style,prepatch){return $node("style").attr("type","text/css").text(style).appendTo(document.documentElement)}function $save(name,value){XNR.options[name]=value;if(XNR.agent==USERSCRIPT){GM_setValue("xnr_options",JSON.stringify(XNR.options))}else{if(XNR.agent==CHROME){chrome.extension.sendRequest({action:"save",data:JSON.stringify(XNR.options)})}}}function PageKit(o){if(!(this instanceof PageKit)){return o?new PageKit(arguments):null}return this.init(o)}PageKit.prototype={init:function(o){this.nodes=[];for(var i=0;i<o.length;i++){var selector=o[i];if(typeof selector=="string"){this.nodes=this.nodes.concat(Array.prototype.slice.call(document.querySelectorAll(selector)))}else{if(selector.nodeType){this.nodes=this.nodes.concat(Array(selector))}else{if(selector instanceof PageKit){this.nodes=this.nodes.concat(o.nodes)}else{this.nodes=this.nodes.concat(Array.prototype.slice.call(selector))}}}}return this},each:function(func){if(typeof func=="function"){for(var i in this.nodes){if(!(func(this.nodes[i],i)==null)){break}}}return this},get:function(index){try{if(index==null){index=0}else{if(index==-1){index=this.nodes.length-1}}return this.nodes[index]}catch(err){return null}},pick:function(index){return PageKit(this.get(index))},remove:function(safe){this.each(function(elem){try{if(!safe||elem.childElementCount==0){elem.parentNode.removeChild(elem)}}catch(err){}});this.nodes=[];return this},purge:function(){this.each(function(elem){try{var p=elem.parentNode;p.removeChild(elem);while(p.childElementCount==0){var q=p.parentNode;q.removeChild(p);p=q}}catch(err){}});this.nodes=[];return this},hide:function(){this.each(function(elem){try{elem.style.display="none"}catch(err){}});return this},show:function(){this.each(function(elem){try{elem.style.display=null;elem.style.visibility=null}catch(err){}});return this},switchTo:function(o){if(typeof o=="string"){o=document.createElement(o)}else{if(o instanceof PageKit){o=o.get()}}if(o.nodeType){var xnr=this;this.each(function(elem,index){var newNode=o.cloneNode(false);while(elem.childNodes.length>0){newNode.appendChild(elem.childNodes[0])}elem.parentNode.replaceChild(newNode,elem);xnr.nodes[index]=newNode})}return this},size:function(){return this.nodes.length},empty:function(){return this.nodes.length==0},heirs:function(index){try{return this.get(index).childElementCount}catch(err){return 0}},index:function(){try{var node=this.get().previousElementSibling;var c=0;for(;node!=null;node=node.previousElementSibling){c++}return c}catch(err){return 0}},superior:function(){try{return PageKit(this.get().parentNode)}catch(err){return null}},previous:function(){try{return PageKit(this.get().previousElementSibling)}catch(err){return null}},next:function(){try{return PageKit(this.get().nextElementSibling)}catch(err){return null}},append:function(o){var node=this.get();if(!node){return this}else{if(node.nodeType==1){if(o instanceof PageKit){o.each(function(elem){node.appendChild(elem)})}else{if(o.nodeType==1){node.appendChild(o)}else{if(typeof o=="string"){node.innerHTML+=o}}}}}return this},insert:function(o,pos){var node=this.get();var xhr=this;if(!node){return this}else{if(node.nodeType==1){if(pos<0){pos=0}else{if(pos>node.childElementCount){pos=node.childElementCount}}if(o instanceof PageKit){o.each(function(elem){xhr.insert(elem,pos);pos++})}else{if(o.nodeType==1){if(pos==node.childElementCount){node.appendChild(o)}else{node.insertBefore(o,node.children[pos])}}else{if(typeof o=="string"){xhr.insert($($node("div",o).get().children),pos)}}}}}return this},prepend:function(o){var node=this.get();if(!node){return this}else{if(node.nodeType==1){if(node.firstElementChild){if(o instanceof PageKit){var insertPlace=node.firstElementChild;o.each(function(elem){node.insertBefore(elem,insertPlace)})}else{if(o.nodeType==1){node.insertBefore(o,node.firstElementChild)}else{if(typeof o=="string"){node.innerHTML=o+node.innerHTML}}}}else{this.append(o)}}}return this},appendTo:function(o){if(o instanceof PageKit){o.append(this)}else{if(o.nodeType==1){PageKit(o).append(this)}}return this},insertTo:function(o,pos){if(o instanceof PageKit){o.insert(this,pos)}else{if(o.nodeType==1){PageKit(o).insert(this,pos)}}return this},prependTo:function(o){if(o instanceof PageKit){o.prepend(this)}else{if(o.nodeType==1){PageKit(o).prepend(this)}}return this},find:function(str){var res=new Array();this.each(function(elem){res=res.concat(Array.prototype.slice.call(elem.querySelectorAll(str)))});return PageKit(res)},filter:function(o){var res=new Array();if(typeof o=="string"){this.each(function(elem){if(elem.querySelector(o)){res.push(elem)}})}else{if(typeof o=="function"){this.each(function(elem){if(o(elem)){res.push(elem)}})}}this.nodes=res;return this},attr:function(o,v){switch(typeof o){case"object":for(var n in o){this.each(function(elem){if(o[n]!=null){elem.setAttribute(n,o[n])}else{elem.removeAttribute(n)}})}return this;case"string":if(v!=null){this.each(function(elem){elem.setAttribute(o,v)});return this}else{try{return this.get().getAttribute(o)}catch(err){return null}}}return this},prop:function(o,v){switch(typeof o){case"object":for(var n in o){this.each(function(elem){elem[n]=o[n]})}return this;case"string":if(v!=null){this.each(function(elem){elem[o]=v});return this}else{try{return this.get()[o]}catch(err){return null}}}return this},style:function(o,v){switch(typeof o){case"object":for(var n in o){this.each(function(elem){try{elem.style[n]=o[n]}catch(err){}})}return this;case"string":if(v!=null){this.each(function(elem){try{elem.style[o]=v}catch(err){}});return this}else{try{return this.get().style[o]}catch(err){return null}}}return this},addClass:function(str){this.each(function(elem){var xnr=$(elem);var c=xnr.attr("class");if(!c.match(new RegExp("\\b"+str+"\\b"))){xnr.attr("class",c+" "+str)}})},removeClass:function(str){this.each(function(elem){var xnr=$(elem);var c=xnr.attr("class");if(c.match(new RegExp("\\b"+str+"\\b"))){xnr.attr("class",c.replace(new RegExp("\\b"+str+"\\b"),"").replace(/^ +| +$/g,""))}})},text:function(txt){if(!(txt==null)){this.each(function(elem){try{elem.textContent=txt}catch(err){try{elem.innerText=txt}catch(err){}}});return this}else{var res;try{res=this.get().textContent}catch(err){try{res=this.get().innerText}catch(err){}}return res||""}},code:function(html){if(!(html==null)){this.each(function(elem){try{elem.innerHTML=html}catch(err){}});return this}else{try{return this.get().innerHTML}catch(err){return""}}},value:function(v){if(v){this.each(function(elem){switch(elem.tagName){case"INPUT":switch($(elem).attr("type").toLowerCase()){case"checkbox":elem.checked=v;break;default:elem.value=v;break}break;case"TEXTAREA":elem.value=v;break;default:$(elem).text(v);break}})}else{var elem=this.get();switch(elem.tagName){case"INPUT":switch($(elem).attr("type").toLowerCase()){case"checkbox":return elem.checked;default:return elem.value}case"TEXTAREA":return elem.value;default:return $(elem).text()}}},hook:function(evt,func){this.each(function(elem){elem.addEventListener(evt,func,false)});return this},invoke:function(evt){this.each(function(elem){try{var e=elem.getAttribute(evt);if(!e){return}if(e.toLowerCase().indexOf("javascript:")!=0){e="javascript:"+e}window.location.href=e}catch(err){$error("invoke",err)}});return this},clone:function(evt){var nodes=[];this.each(function(elem){nodes.push(elem.cloneNode(true))});return PageKit(nodes)}};switch(XNR.agent){case USERSCRIPT:main(JSON.parse(GM_getValue("xnr_options","{}")));break;case CHROME:chrome.extension.sendRequest({action:"load"},function(response){main(response.options)});break;case FIREFOX:main({});default:throw"unsupported browser"}})(typeof docWindow=="undefined"?window:docWindow);}

var myListener={
	QueryInterface: function(aIID) {
		if (aIID.equals(Components.interfaces.nsIWebProgressListener) || 
				aIID.equals(Components.interfaces.nsISupportsWeakReference) || 
				aIID.equals(Components.interfaces.nsISupports)) {
			return this;
		}
		throw Components.results.NS_NOINTERFACE;
	},
	onLocationChange: function(aProgress, aRequest, aURI) {
		if(content.document.readyState=="loading") {
			loader();
		}
	},
	onProgressChange: function(aWebProgress, aRequest, curSelf, maxSelf, curTot, maxTot) { },
	onStateChange: function(aWebProgress, aRequest, aFlag, aStatus) { },  
	onStatusChange: function(aWebProgress, aRequest, aStatus, aMessage) { },
	onSecurityChange: function(aWebProgress, aRequest, aState) { }
};

window.addEventListener("load",function() {
	gBrowser.addProgressListener(myListener,Components.interfaces.nsIWebProgress.NOTIFY_LOCATION);
	gBrowser.addEventListener("DOMContentLoaded",loader,true);
},false);

window.addEventListener("unload",function() {
	gBrowser.removeEventListener("DOMContentLoaded",loader,true);
	gBrowser().removeProgressListener(myListener,Components.interfaces.nsIWebProgress.NOTIFY_LOCATION);
},false);

